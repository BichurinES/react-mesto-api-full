{"ast":null,"code":"import{useHistory}from'react-router-dom';import EntryForm from'./EntryForm';import*as auth from'./Auth';import{Link}from'react-router-dom';import{CurrentUserContext}from'../contexts/CurrentUserContext';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function Register(props){var history=useHistory();function handleSubmit(_ref){var email=_ref.email,password=_ref.password;auth.register({email:email,password:password}).then(function(res){if(res.error){props.handleUpdateInfoTooltip({title:res.error,isSuccess:false});props.handleInfoTooltipShow();}else{props.handleUpdateEmail(res.data.email);props.handleUpdateInfoTooltip({title:'Вы успешно зарегистрировались!',isSuccess:true});props.handleInfoTooltipShow();auth.login({email:email,password:password}).then(function(res){localStorage.setItem('token',res.token);});props.handleLogged();history.push('/');}}).catch(function(){props.handleUpdateInfoTooltip({title:'Что-то пошло не так! Попробуйте ещё раз.',isSuccess:false});props.handleInfoTooltipShow();});}return/*#__PURE__*/_jsx(EntryForm,{name:\"register\",title:\"\\u0420\\u0435\\u0433\\u0438\\u0441\\u0442\\u0440\\u0430\\u0446\\u0438\\u044F\",buttonText:\"\\u0417\\u0430\\u0440\\u0435\\u0433\\u0438\\u0441\\u0442\\u0440\\u0438\\u0440\\u043E\\u0432\\u0430\\u0442\\u044C\\u0441\\u044F\",handleSubmit:handleSubmit,children:/*#__PURE__*/_jsxs(\"p\",{className:\"entry__caption\",children:[\"\\u0423\\u0436\\u0435 \\u0437\\u0430\\u0440\\u0435\\u0433\\u0438\\u0441\\u0442\\u0440\\u0438\\u0440\\u043E\\u0432\\u0430\\u043D\\u044B? \",/*#__PURE__*/_jsx(Link,{className:\"entry__link\",to:\"/sign-in\",children:\"\\u0412\\u043E\\u0439\\u0442\\u0438\"})]})});}export default Register;","map":{"version":3,"sources":["/Users/egorbicurin/Library/Mobile Documents/com~apple~CloudDocs/Яндекс.Практикум/mesto-react-auth/src/components/Register.js"],"names":["useHistory","EntryForm","auth","Link","CurrentUserContext","Register","props","history","handleSubmit","email","password","register","then","res","error","handleUpdateInfoTooltip","title","isSuccess","handleInfoTooltipShow","handleUpdateEmail","data","login","localStorage","setItem","token","handleLogged","push","catch"],"mappings":"AAAA,OAASA,UAAT,KAA2B,kBAA3B,CACA,MAAOC,CAAAA,SAAP,KAAsB,aAAtB,CACA,MAAO,GAAKC,CAAAA,IAAZ,KAAsB,QAAtB,CACA,OAASC,IAAT,KAAqB,kBAArB,CACA,OAASC,kBAAT,KAAmC,gCAAnC,C,wFAEA,QAASC,CAAAA,QAAT,CAAkBC,KAAlB,CAAyB,CACvB,GAAMC,CAAAA,OAAO,CAAGP,UAAU,EAA1B,CAEA,QAASQ,CAAAA,YAAT,MAAyC,IAAlBC,CAAAA,KAAkB,MAAlBA,KAAkB,CAAXC,QAAW,MAAXA,QAAW,CACvCR,IAAI,CAACS,QAAL,CAAc,CAACF,KAAK,CAALA,KAAD,CAAQC,QAAQ,CAARA,QAAR,CAAd,EACGE,IADH,CACQ,SAACC,GAAD,CAAS,CACb,GAAIA,GAAG,CAACC,KAAR,CAAe,CACbR,KAAK,CAACS,uBAAN,CAA8B,CAACC,KAAK,CAAEH,GAAG,CAACC,KAAZ,CAAmBG,SAAS,CAAE,KAA9B,CAA9B,EACAX,KAAK,CAACY,qBAAN,GACD,CAHD,IAGO,CACLZ,KAAK,CAACa,iBAAN,CAAwBN,GAAG,CAACO,IAAJ,CAASX,KAAjC,EACAH,KAAK,CAACS,uBAAN,CAA8B,CAACC,KAAK,CAAE,gCAAR,CAA0CC,SAAS,CAAE,IAArD,CAA9B,EACAX,KAAK,CAACY,qBAAN,GACAhB,IAAI,CAACmB,KAAL,CAAW,CAACZ,KAAK,CAALA,KAAD,CAAQC,QAAQ,CAARA,QAAR,CAAX,EAA8BE,IAA9B,CAAmC,SAACC,GAAD,CAAS,CAC1CS,YAAY,CAACC,OAAb,CAAqB,OAArB,CAA8BV,GAAG,CAACW,KAAlC,EACD,CAFD,EAGAlB,KAAK,CAACmB,YAAN,GACAlB,OAAO,CAACmB,IAAR,CAAa,GAAb,EACD,CACF,CAfH,EAgBGC,KAhBH,CAgBS,UAAM,CACXrB,KAAK,CAACS,uBAAN,CAA8B,CAACC,KAAK,CAAE,0CAAR,CAAoDC,SAAS,CAAE,KAA/D,CAA9B,EACAX,KAAK,CAACY,qBAAN,GACD,CAnBH,EAoBD,CAED,mBACE,KAAC,SAAD,EAAW,IAAI,CAAC,UAAhB,CAA2B,KAAK,CAAC,oEAAjC,CAA+C,UAAU,CAAC,8GAA1D,CAA+E,YAAY,CAAEV,YAA7F,uBACE,WAAG,SAAS,CAAC,gBAAb,gJAAoD,KAAC,IAAD,EAAM,SAAS,CAAC,aAAhB,CAA8B,EAAE,CAAC,UAAjC,4CAApD,GADF,EADF,CAKD,CACD,cAAeH,CAAAA,QAAf","sourcesContent":["import { useHistory } from 'react-router-dom';\nimport EntryForm from './EntryForm';\nimport * as auth from './Auth';\nimport { Link } from 'react-router-dom';\nimport { CurrentUserContext } from '../contexts/CurrentUserContext';\n\nfunction Register(props) {\n  const history = useHistory();\n\n  function handleSubmit({email, password}) {\n    auth.register({email, password})\n      .then((res) => {\n        if (res.error) {\n          props.handleUpdateInfoTooltip({title: res.error, isSuccess: false});\n          props.handleInfoTooltipShow();\n        } else {\n          props.handleUpdateEmail(res.data.email);\n          props.handleUpdateInfoTooltip({title: 'Вы успешно зарегистрировались!', isSuccess: true});\n          props.handleInfoTooltipShow();\n          auth.login({email, password}).then((res) => {\n            localStorage.setItem('token', res.token);\n          })\n          props.handleLogged();\n          history.push('/');\n        }\n      })\n      .catch(() => {\n        props.handleUpdateInfoTooltip({title: 'Что-то пошло не так! Попробуйте ещё раз.', isSuccess: false});\n        props.handleInfoTooltipShow();\n      })\n  }\n\n  return (\n    <EntryForm name=\"register\" title=\"Регистрация\" buttonText=\"Зарегистрироваться\" handleSubmit={handleSubmit}>\n      <p className=\"entry__caption\">Уже зарегистрированы? <Link className=\"entry__link\" to=\"/sign-in\">Войти</Link></p>\n    </EntryForm>\n  );\n}\nexport default Register;"]},"metadata":{},"sourceType":"module"}